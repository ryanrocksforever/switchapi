<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AMAZ-TECH | Fetch API</title>
    <link rel="stylesheet" href="style/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">
    <style>
        .w3-allerta {
            font-family: "Allerta Stencil", Sans-serif;
        }
    </style>


</head>

<body class="page_bg">

    <div>
                    <div class="well">
                        <div id="generic-content-form">
                            <iframe width="0" height="0" border="0" name="dummyframe" id="dummyframe"></iframe>
                            <form action="https://switch-hub.local:80/account" method="POST" target="dummyframe">
                                <fieldset>
                                <div class="control-group">
                                    <label style="visibility: hidden;" for="id__content_type" class="control-label">Media type:</label>
                                    <div style="visibility: hidden;" class="controls">
                                        <select style="visibility: hidden;" id="id__content_type" name="_content_type">
                                        <option style="visibility: hidden;" value="application/json"  selected="selected">application/json</option>

                                        </select>
                                        <span style="visibility: hidden;" class="help-block"></span>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label style="visibility: hidden;" for="id__content" class="control-label">Content:</label>
                                    <div class="controls">
                                        <!--<textarea name="_content" cols="40" rows="10">{"id": "posasd"}</textarea> -->
                                        <p>Username</p>
                                        <input type="text" id="myInput" oninput="myFunction()">

                                        <p id="demo"></p>

                                        <script>
                                            const fetchPromise = fetch("https://switch-hub.local:80/account");
                                            // Target main element
                                            const main = document.getElementById("main1");
                                            fetchPromise.then(response => {
                                                return response.json();
                                            }).then(people => {
                                                const names = people.id;
                                                // Append names to main element
                                                console.log(names);
                                                return(names);
                                            });

                                            var userid = names;
                                            function myFunction(userid) {

                                              var x = document.getElementById("myInput").value;
                                              var start = "{\"id\": \"";
                                              var end = "\"}";

                                              var res = start.concat(x, end);

                                              document.getElementById("demo").innerHTML = "You wrote: " + x;
                                              if (x = userid){
                                                document.getElementById("_content").value = "Already Registered";
                                                element = document.querySelector('.form-control-plaintext');
                                                element1 = document.querySelector('.btn btn-primary');
                                                element.style.visibility = 'hidden';
                                                element1.style.visibility = 'hidden';
                                              } else {
                                                document.getElementById("_content").value = res;
                                              }

                                               }
                                        </script>
                                        <input style="visibility: hidden;" type="text" readonly name="_content" class="form-control-plaintext" id="_content" >
                                    </div>
                                </div>
                                <div class="form-actions">

                                    <button class="btn btn-primary" onclick="location.href = 'https://ryanindustries.atamenterprise.net/?page_id=134';" title="Make a POST request on the resource">Register</button>



                                    </div>
                                </fieldset>
                            </form>
                        </div>
                    </div>
                </div>




</body>

</html>